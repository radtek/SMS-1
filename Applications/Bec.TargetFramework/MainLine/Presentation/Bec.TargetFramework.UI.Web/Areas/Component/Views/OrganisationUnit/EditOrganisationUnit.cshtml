@using Ext.Net.MVC
@using Ext.Net
@using Bec.TargetFramework.Web.Framework.Extensions
@model Bec.TargetFramework.Entities.OrganisationUnitDTO

@{
    ViewBag.Title = "Edit Organisation Unit";
    Layout = "~/Views/Shared/_BaseLayout.cshtml";
}

@section mainBody
{

    @(Html.X()
          .FormPanel()
          .ID("EditOrganisationUnitForm")
          .BodyPadding(5)
          .Flex(1)
          .Items
          (
          Html.X().AntiForgeryField(),
                   Html.X()
                      .Container()
                      .Layout(LayoutType.Form)
                      .ColumnWidth(1)
                      .Padding(2)
                      .Items(
                         Html.X().MultiSelect().ID("FormErrors").Hidden(true)),
                         Html.X().HiddenFor(model => Model.IsConcreteOrganisation),
                         Html.X().HiddenFor(model => Model.OrganisationID),
           Html.X()
                   .HiddenFor(model => model.UnitJson),
                   Html.X()
                           .HiddenFor(model => model.OrganisationUnitID),
                                   Html.X().TextFieldFor(model => model.Name).ApplyTextFieldDefaults(Razor.ApplyTextFieldDefaults).ReadOnly(true)
                              .AllowBlank(false)
                                     .ApplyTextFieldDefaults(Razor.ApplyTextFieldDefaults)
                                     
          )
          .DefaultAnchor("100%")
          .TopBar(Html.X().Toolbar()
                    .Items(
                        Html.X().ToolbarFill(),
                            Html.X()
                                   .Button()
                                   .ApplyButtonDefaults(Razor.ApplySaveButtonDefaults)
                               .DirectEvents(de =>
                               {
                                   de.Click.Before = "return #{EditOrganisationUnitForm}.isValid();";
                                   de.Click.Url = Url.Action("EditOrganisationUnit", "OrganisationUnit", new { area = "Component" });
                                   de.Click.FormID = "EditOrganisationUnitForm";

                               }),

                                                           Html.X().Button().ApplyButtonDefaults(Razor.ApplyResetButtonDefaults).OnClientClick("#{EditOrganisationUnitForm}.getForm().reset();"),
                                                           Html.X().Button().ApplyButtonDefaults(Razor.ApplyCancelButtonDefaults).OnClientClick("#{EditOrganisationUnitForm}.getForm().reset();Ext.net.Bus.publish('EditOrganisationUnit','');")
                            ))
    )

}