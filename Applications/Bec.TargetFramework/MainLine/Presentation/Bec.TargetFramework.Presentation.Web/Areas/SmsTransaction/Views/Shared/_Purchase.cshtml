@using Bec.TargetFramework.Entities

<div class="modal fade in" tabindex="-1" role="dialog" aria-labelledby="purchaseLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="purchaseLabel">Purchase Product</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-12">
                        <form id="purchase-form" class="smart-form">
                            @Html.ValidationBootstrap()
                            @Html.AntiForgeryToken()
                            <fieldset>
                                <input type="hidden" name="smsTransactionId" value="@ViewBag.SmsTransactionId" />

                                <div class="row">
                                    <section class="col col-6">
                                        <label class="select">
                                            <select name="product">
                                                <option>Product</option>
                                            </select>
                                            <i></i>
                                        </label>
                                    </section>
                                </div>

                                <div class="row">
                                    <section class="col">
                                        <label class="label">Product Price:</label>
                                        <label class="label">£0.00</label>
                                    </section>
                                </div>

                                <div class="row">
                                    <section class="col">
                                        <label class="label">@ViewBag.CompanyName</label>
                                    </section>
                                </div>

                                <div class="row">
                                    <section class="col">
                                        <label class="label">Credit Balance (as of @DateTime.Now)</label>
                                    </section>
                                </div>

                                <div class="row">
                                    <section class="col col-8">
                                        <label class="label">£0.00</label>
                                    </section>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-sm btn-default pull-left">Top up</button>
                <button type="button" class="btn btn-sm btn-default pull-left">Refresh</button>
                <button type="button" id="cancelPurchase" class="btn btn-default" data-dismiss="modal">
                    Cancel
                </button>
                <button type="button" id="submitPurchase" class="btn btn-primary">
                    Purchase
                </button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    $("#submitPurchase").click(function () {
        $("#submitPurchase").prop('disabled', true);
        var formData = $("#purchase-form").serializeArray();
        ajaxWrapper({
            url: '@Url.Action("Purchase", "Buyer", new { area = "SmsTransaction" })',
            type: "POST",
            data: formData
        }).done(function (res) {
            if (res.result == true)
                hideCurrentModal();
            else
                handleModal({ url: '@Url.Action("ViewMessage", "Home", new { Area = "", })' + "?title=" + res.title + "&message=" + res.message + "&button=Back" }, {
                    messageButton: function () {
                        $("#submitPurchase").prop('disabled', false);
                    }
                }, true);
        }).fail(function (e) {
            handleModal({ url: '@Url.Action("ViewMessage", "Home", new { Area = "" })' + "?title=Error&message=" + e + "&button=Back" }, {
                messageButton: function () {
                    $("#submitPurchase").prop('disabled', false);
                }
            }, true);
        });

    })
</script>
